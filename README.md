# LeetCode 裁员晴雨表监控系统 📊

## 项目简介

这是一个基于LeetCode题目提交数据的市场热度监控系统，通过分析多道经典题目的提交量变化，推测程序员求职市场的活跃度，作为"裁员晴雨表"的参考指标。

### 核心原理
- 当求职市场火热时，刷题人数增加，题目提交量上升
- 提交量激增可能意味着求职竞争加剧（裁员风险高）
- 通过多题目综合指数、趋势加速度、季节性调整等多维度分析，评估市场风险

## 功能特点

### 1. 多题目数据采集
- 同时监控12道经典题目（简单、中等、困难各4道）
- 避免单一题目的偏差，提高数据准确性
- 自动重试和降级机制，确保数据采集稳定

### 2. 智能风险算法
```
风险指数 = (基础指数 × 40% + 加速度 × 30% + 历史对比 × 20%) × 季节因子
```
- **基础指数**：基于当日提交增量，按难度加权计算
- **加速度**：分析最近14天的趋势变化速度
- **历史对比**：与历史平均值对比
- **季节因子**：旺季1.3，淡季0.8

### 3. 多维度分析
- 📈 **历史趋势**：30天趋势分析
- ⚡ **加速度分析**：判断趋势是加速还是减速
- 🎯 **难度分布**：各难度题目的热度分布
- 🏢 **公司热度**：FAANG、中国科技公司等热度分布

### 4. 可视化仪表盘
- 风险仪表盘直观显示当前风险指数
- 红黄绿三色预警系统
- 结论和建议自动生成
- 每日自动保存图表

### 5. 风险等级划分
| 风险指数 | 等级 | 说明 | 建议 |
|---------|------|------|------|
| >80% | 高危 🔥 | 裁员风险极高，市场异常活跃 | 立即关注市场动态，做好应急预案 |
| 60-80% | 预警 ⚠️ | 裁员风险较高，需要警惕 | 保持关注，适当调整招聘计划 |
| 40-60% | 关注 👀 | 中等风险，正常波动范围内 | 定期监控，维持现状 |
| 20-40% | 低风险 | 市场相对平稳 | 正常运营，可适当招聘 |
| <20% | 安全 ✅ | 市场冷清，风险较低 | 适合储备人才，等待时机 |

## 安装部署

### 环境要求
- Python 3.7+
- pip包管理工具

### 安装依赖
```bash
pip install requests matplotlib numpy
```

### 下载代码
将代码保存为 `recession_monitor.py`

## 使用方法

### 运行程序
```bash
python recession_monitor.py
```

### 交互式菜单
```
============================================================
📊 裁员晴雨表监控系统
============================================================
1. 🚀 运行监控系统
2. 🔍 运行API诊断
3. 📈 查看历史数据统计
4. ❌ 退出
============================================================
```

#### 选项1：运行监控系统
- 立即采集所有题目数据
- 计算风险指数
- 生成可视化仪表盘
- 自动保存历史数据

#### 选项2：运行API诊断
- 检查网络连接
- 测试API访问状态
- 诊断GraphQL接口
- 提供问题排查建议

#### 选项3：查看历史数据统计
- 显示总记录天数
- 平均/最高/最低风险指数
- 最近7天趋势图

## 输出文件

### 数据文件
- **`recession_history.json`**：所有历史指数数据
  ```json
  {
    "2024-01-15": {
      "index": 2.34,
      "probability": 45.6,
      "problems": [...]
    }
  }
  ```

### 图表文件
- **`recession_dashboard_YYYYMMDD_HHMM.png`**：每日仪表盘
- **`recession_dashboard_latest.png`**：最新仪表盘（固定文件名）

### 日志文件
- **`recession_monitor.log`**：运行日志

## 监控题目列表

### 简单难度（权重0.3-0.2）
| 题目 | Slug | 权重 |
|------|------|------|
| 两数之和 | two-sum | 0.3 |
| 有效的括号 | valid-parentheses | 0.25 |
| 合并有序链表 | merge-two-sorted-lists | 0.25 |
| 买卖股票 | best-time-to-buy-and-sell-stock | 0.2 |

### 中等难度（权重0.3-0.2）
| 题目 | Slug | 权重 |
|------|------|------|
| 两数相加 | add-two-numbers | 0.3 |
| 无重复字符子串 | longest-substring-without-repeating-characters | 0.25 |
| 三数之和 | 3sum | 0.25 |
| 盛水容器 | container-with-most-water | 0.2 |

### 困难难度（权重0.3-0.2）
| 题目 | Slug | 权重 |
|------|------|------|
| 两个有序数组的中位数 | median-of-two-sorted-arrays | 0.3 |
| 合并K个有序链表 | merge-k-sorted-lists | 0.25 |
| 正则表达式匹配 | regular-expression-matching | 0.25 |
| 接雨水 | trapping-rain-water | 0.2 |

## 技术架构

### 模块说明
```
recession_monitor.py
├── 工具函数
│   ├── setup_chinese_font()    # 设置中文字体
│   ├── create_session_with_retries()  # 创建带重试的会话
│   └── check_dependencies()     # 检查依赖
├── 数据采集模块
│   └── MultiProblemCollector    # 多题目数据采集器
├── 指数计算模块
│   └── RecessionIndexCalculator # 裁员指数计算器
├── 可视化模块
│   └── RecessionDashboard       # 裁员监控仪表盘
├── 诊断模块
│   └── APIDiagnostic            # API诊断工具
└── 主程序入口
    └── main()                    # 主函数
```

### 数据流
1. 采集12道题目的提交数据
2. 计算当日增量（与昨日对比）
3. 按难度和权重加权计算基础指数
4. 分析趋势加速度
5. 考虑季节性因素
6. 生成综合风险指数
7. 保存历史数据
8. 生成可视化仪表盘

## 常见问题

### Q1: API请求失败怎么办？
运行选项2的API诊断工具，它会：
- 检查网络连接
- 测试各个API端点
- 提供具体的问题排查建议

### Q2: 数据准确吗？
- 使用多题目综合指数，避免单一偏差
- 有备用API和演示数据机制
- 建议长期运行积累数据，趋势比绝对值更有参考价值

### Q3: 可以修改监控的题目吗？
可以在 `MultiProblemCollector` 类的 `__init__` 方法中修改 `self.problems` 字典。

### Q4: 出现中文字体警告怎么办？
程序已自动配置中文字体，如果仍有警告，可以：
- Windows：安装微软雅黑字体
- Linux：`sudo apt-get install fonts-wqy-zenhei`
- macOS：系统通常自带中文字体

### Q5: 如何调整风险算法？
可以在 `RecessionIndexCalculator.calculate_recession_probability()` 方法中修改：
- 各项指标的权重
- 季节因子数值
- 风险等级阈值

## 最佳实践

### 长期运行
```bash
# Linux/Mac 后台运行
nohup python recession_monitor.py > /dev/null 2>&1 &

# Windows 后台运行
pythonw.exe recession_monitor.py
```

### 定时采集
程序已内置定时逻辑，每天00:00、08:00、16:00自动采集（需保持运行）

### 数据备份
定期备份 `recession_history.json` 文件

## 更新日志

### v2.1 (2024-01-15)
- 修复GraphQL API 400错误
- 添加公共API备用机制
- 增加演示数据生成功能
- 优化请求间隔和重试策略

### v2.0 (2024-01-10)
- 支持多题目采集
- 添加季节性调整
- 增加趋势加速度分析
- 改进可视化仪表盘

### v1.0 (2024-01-01)
- 初始版本发布
- 支持单题目监控
- 基础图表功能

## 许可证

MIT License

## 免责声明

本工具仅供学习参考，数据解读可能存在偏差，请理性看待。裁员决策应考虑多方面因素，切勿仅凭本工具数据做出判断。

---

**如果觉得这个工具有用，欢迎Star！** ⭐

**遇到问题？** 运行选项2的API诊断工具获取帮助